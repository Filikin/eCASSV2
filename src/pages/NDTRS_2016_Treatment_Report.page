<!--
    Author: Eamon Kelly, Enclude
    Purpose: Prepare a CSV file for upload to the HRB 
    Called from: Button on NDTRS_2016_Report
    Tested in: TestNDTRSReports
    
    21/06/2017 removed [InterEndDate26] ,[InterNumber26] ,- not on new form
-->
<apex:page standardController="NDTRS_2016_Report__c" extensions="NDTRS2016ReportController" cache="false" contentType="text/csv#ndtrs2016rbreport.csv" showHeader="false" sidebar="false" readonly="true">Forename,Surname,County,Address1,Address2,Address3,Eircode,Small_Area, DED, LHO, TFA, CHO, UFI, Service_Provider, Centre_Type, Service_User_Number, IHI, Consent, Sex, Transgender, Sexuality, DOB, Age, Living_Where, Living_With, No_Children, Child_U5_WithClient, Child_5to17_WithClient, Child_O18_WithClient, Child_Unknown_WithClient, Child_U5_OtherParent, Child_5to17_OtherParent, Child_O18_OtherParent, Child_Unknown_OtherParent, Child_U5_InCare, Child_5to17_InCare, Child_O18_InCare, Child_Unknown_InCare, Child_U5_Else, Child_5to17_Else, Child_Over18_Else, Child_Unknown_Else, Child_U5_NotKnown, Child_5to17_NotKnown, Child_Over18_NotKnown, Child_Unknown_NotKnown, Education, Education_Age, Employment, Other_Employment, Country_Of_Birth, Ethnic, Language, Referral_Date, Main_Problem, Source_Of_Referral, Date_Of_Assessment, Assessment_Outcome, Suitable_For_Tx, Suitable_For_Tx_Specify, Times_Tx, Drug_History, Age_1st_Tx_Drug, Alcohol_History, Age_1st_Tx_Alcohol, Other_Problem_History, Other_Problem_History_Name, Age_1st_Tx_OtherProblem, Ever_Received_Opiate_Sub, Age_1st_OpiateSub, Drug_1, Drug_1_Route, Drug_1_Frequency, Drug_1_Age, Drug_2, Drug_2_Route, Drug_2_Frequency, Drug_2_Age, Drug_3, Drug_3_Route, Drug_3_Frequency, Drug_3_Age, Drug_4, Drug_4_Route, Drug_4_Frequency, Drug_4_Age, Drug_5, Drug_5_Route, Drug_5_Frequency, Drug_5_Age, 1st_Age_Drug, 1st_Drug, Difficult_To_Assess, Beer, Spirits, Wine, Fortified_Wine, Cider, Alcopops,Other, Prefer_Other_Specify, Standard_Drinks, Alcohol_Extent, Alcohol_Detox_History, Injected_Ever, Injected_Age_1st, Injected_Frequency, Shared_Needle, Shared_Other, HepC_Test, HepB_Test, HIV_Test, Brief_Intervention, Brief_Intervention_Start, Brief_Intervention_End, Brief_Intervention_Sessions, Counsel_Individual, Counsel_Individual_Start, Counsel_Individual_End, Counsel_Individual_Sessions, Counsel_Group, Counsel_Group_Start, Counsel_Group_End, Counsel_Group_Sessions, Individual_Edu, Individual_Edu_Start, Individual_Edu_End, Individual_Edu_Sessions, Group_Edu, Group_Edu_Start, Group_Edu_End, Group_Edu_Sessions, Medication_Free, Medication_Free_Start, Medication_Free_End, Medication_Free_Sessions, Complementary, Complementary_Start, Complementary_End, Complementary_Sessions, Social_Occ, Social_Occ_Start, Social_Occ_End, Social_Occ_Sessions, Family_Therapy, Family_Therapy_Start, Family_Therapy_End, Family_Therapy_Sessions, Aftercare, Aftercare_Start, Aftercare_End, Aftercare_Sessions, Strength_Family, Strength_Family_Start, Strength_Family_End, Strength_Family_Sessions, Psychiatric, Psychiatric_Start, Psychiatric_End, Psychiatric_Sessions, Multi1, Multi1_Start, Multi1_End, Multi1_Sessions, Multi2, Multi2_Start, Multi2_End, Multi2_Sessions, Methadone, Methadone_Start, Methadone_End, Methadone_Sessions, Buprenorphine, Buprenorphine_Start, Buprenorphine_End, Buprenorphine_Sessions, Detox_Alcohol, Detox_Alcohol_Start, Detox_Alcohol_End, Detox_Alcohol_Sessions, Assist_Detox_A1, Assist_Detox_A2, Assist_Detox_A3, Detox_Heroin, Detox_Heroin_Start, Detox_Heroin_End, Detox_Heroin_Sessions, Assist_Detox_B1, Assist_Detox_B2, Assist_Detox_B3, Detox_Methadone, Detox_Methadone_Start, Detox_Methadone_End, Detox_Methadone_Sessions, Assist_Detox_C1, Assist_Detox_C2, Assist_Detox_C3, Detox_Benzo, Detox_Benzo_Start, Detox_Benzo_End, Detox_Benzo_Sessions, Assist_Detox_D1, Assist_Detox_D2, Assist_Detox_D3, Detox_Zdrugs, Detox_ZDrugs_Start, Detox_ZDrugs_End, Detox_ZDrugs_Sessions, Assist_Detox_E1, Assist_Detox_E2, Assist_Detox_E3, Detox_Other, Detox_Other_Specify, Detox_Other_Start, Detox_Other_End, Detox_Other_Sessions, Assist_Detox_F1, Assist_Detox_F2, Assist_Detox_F3, Detox_Community, Detox_Community_Start, Detox_Community_End, Detox_Community_Sessions, Key_Worker, Key_Worker_Start, Key_Worker_End, Key_Worker_Sessions, Case_Manager, Case_Manager_Start, Care_Plan, Care_Plan_Start, SAOR, SAOR_Start, SAOR_End, SAOR_Sessions, Other2, Other2_Start, Other2_End, Other2_Sessions, Exit_Reason, Exit_Centre, Premature_Exit_Reason, Exit_Reason_Specify, CP_Number, Drug_Free, Not_Changed_Drug_Use, Increased_Drug_Use, Reduced_Drug_Use, Abstaining_From_Alcohol, Not_Changed_Alcohol_Use, Increased_Alcohol_Use, Reduced_Alcohol_Use, Sub_Reached_Goals_Of_Care_Plan, Engaging_With_Care_Plan, Disengaged_From_Care_Plan, Care_Plan_Gaps_Blocks, Engaging_With_Other_Services, Engaging_With_Other_Therapeutic_Services, Engaging_Unstructured_Aftercare, Other3, Not_Known, Client_Discharge_Condition_Other_Specify, Exit_Date, Third_Party_ID, Episode_Comment, Created_By
        <apex:repeat value="{!treatmentWrappers}" var="treatWrap">
        ,
<apex:outputText rendered="{!treatWrap.treat.ISConcernedPerson__c}">,{!treatWrap.treat.Contact__r.County_code_for_HRB__c},,,,,{!treatWrap.treat.Contact__r.Small_Area__c},{!treatWrap.treat.Contact__r.DED__c},{!treatWrap.treat.Contact__r.LHO_Code__c},{!treatWrap.treat.Contact__r.TFA_Code__c},{!treatWrap.treat.Contact__r.CHO__c},,{!treatWrap.treat.Centre_number__c},{!treatWrap.treat.CentreType__c},{!treatWrap.treat.Contact__r.NUMBER__c},{!treatWrap.treat.Contact__r.X2b_IHI__c},,{!treatWrap.treat.Contact__r.Sex__c},{!treatWrap.treat.Contact__r.Transgender_Code__c},{!treatWrap.treat.Contact__r.Sexuality_Code__c},<apex:outputText value="{0,date,dd/MM/yyyy}"><apex:param value="{!treatWrap.treat.Contact__r.Birthdate}"/></apex:outputText>,{!treatWrap.treat.Age__c},{!treatWrap.treat.Contact__r.Living_Where__c},{!treatWrap.treat.Contact__r.Living_With__c},{!treatWrap.treat.Contact__r.X6_Total_Number_of_Children__c},{!treatWrap.treat.Contact__r.X6a1_Children_under_5yrs_living_whith__c},{!treatWrap.treat.Contact__r.X6a2_Children_5_17yrs_living_whith_clien__c},{!treatWrap.treat.Contact__r.X6a3_Children_18yrs_or_over_living_whith__c},{!treatWrap.treat.Contact__r.Living_with_service_user_unknown__c},{!treatWrap.treat.Contact__r.X6b1_Children_under_5_yrs_living_w_other__c},{!treatWrap.treat.Contact__r.X6b2_Children_5_17yrs_living_w_other__c},{!treatWrap.treat.Contact__r.X6b3_Children_18yrs_or_over_living_other__c},{!treatWrap.treat.Contact__r.Living_with_other_parent_unknown__c},{!treatWrap.treat.Contact__r.X6c1_Children_under_5yrs_in_care__c},{!treatWrap.treat.Contact__r.X6c2_Children_5_17yrs_in_care__c},{!treatWrap.treat.Contact__r.X6c3_Children_18yrs_or_over_in_care__c},{!treatWrap.treat.Contact__r.Number_in_care_unknown__c},{!treatWrap.treat.Contact__r.X6d1_Children_under_5yrs_living_elsewher__c},{!treatWrap.treat.Contact__r.X6d2_Children_5_17yrs_living_elsewhere__c},{!treatWrap.treat.Contact__r.X6d3_Children_18yrs_or_over_living_elsew__c},{!treatWrap.treat.Contact__r.Living_elsewhere_unknown__c},{!treatWrap.treat.Contact__r.X6e1_Children_under_5yrs_living_not_know__c},{!treatWrap.treat.Contact__r.X6e2_Children_5_17yrs_living_not_know__c},{!treatWrap.treat.Contact__r.X6e3_Children_18yrs_or_over_living_not_k__c},{!treatWrap.treat.Contact__r.Living_status_not_known_unknown__c},{!treatWrap.treat.Contact__r.EDUCATION__c},{!treatWrap.treat.Contact__r.Education_Age__c},{!treatWrap.treat.Contact__r.EMPLOYMENT__c},{!treatWrap.treat.Contact__r.X10_8_Specify_other_employment_status__c},{!treatWrap.treat.Contact__r.Country_Of_Birth__c},{!treatWrap.treat.Contact__r.Ethnic_cultural_background__c},{!treatWrap.treat.Contact__r.Language__c},<apex:outputText value="{0,date,dd/MM/yyyy}"><apex:param value="{!treatWrap.treat.X12_Date_of_Referral__c}"/></apex:outputText>,{!treatWrap.treat.X13_2_Drug_specify__r.Item_Code__c},{!treatWrap.treat.Source_of_Referral__c},<apex:outputText value="{0,date,dd/MM/yyyy}"><apex:param value="{!treatWrap.treat.X15_Date_of_initial_assessment__c}"/></apex:outputText>,{!treatWrap.treat.Assessment_Outcome__c},{!treatWrap.treat.ClientSuitable__c},Concerned Person form,{!treatWrap.treat.Times__c},88,88,88,88,88,88,88,88,88,994,88,88,88,,,,,,,,,,,,,,,,,88,88,88,FALSE,FALSE,FALSE,FALSE,FALSE,FALSE,FALSE,,,,,,,,,,{!treatWrap.treat.HepC_Test__c},{!treatWrap.treat.HepB_Test__c},{!treatWrap.treat.HIV_Test__c},{!treatWrap.treat.Brief_Intervention__c},<apex:outputText value="{0,date,dd/MM/yyyy}"><apex:param value="{!treatWrap.treat.X32b1_Date_started__c}"/></apex:outputText>,<apex:outputText value="{0,date,dd/MM/yyyy}"><apex:param value="{!treatWrap.treat.X32c1_Date_of_last_visit__c}"/></apex:outputText>,{!treatWrap.treat.X32d1_Number_of_sessions__c},{!treatWrap.treat.Counsel_Individual__c},<apex:outputText value="{0,date,dd/MM/yyyy}"><apex:param value="{!treatWrap.treat.X32b2_Date_started__c}"/></apex:outputText>,<apex:outputText value="{0,date,dd/MM/yyyy}"><apex:param value="{!treatWrap.treat.X32c2_Date_of_last_visit__c}"/></apex:outputText>,{!treatWrap.treat.X32d2_Number_of_sessions__c},{!treatWrap.treat.Counsel_Group__c},<apex:outputText value="{0,date,dd/MM/yyyy}"><apex:param value="{!treatWrap.treat.X32b3_Date_started__c}"/></apex:outputText>,<apex:outputText value="{0,date,dd/MM/yyyy}"><apex:param value="{!treatWrap.treat.X32c3_Date_of_last_visit__c}"/></apex:outputText>,{!treatWrap.treat.X32d3_Number_of_sessions__c},{!treatWrap.treat.Individual_Edu__c},<apex:outputText value="{0,date,dd/MM/yyyy}"><apex:param value="{!treatWrap.treat.X32b4_Date_started__c}"/></apex:outputText>,<apex:outputText value="{0,date,dd/MM/yyyy}"><apex:param value="{!treatWrap.treat.X32c4_Date_of_last_visit__c}"/></apex:outputText>,{!treatWrap.treat.X32d4_Number_of_sessions__c},{!treatWrap.treat.Group_Edu__c},<apex:outputText value="{0,date,dd/MM/yyyy}"><apex:param value="{!treatWrap.treat.X32b5_Date_started__c}"/></apex:outputText>,<apex:outputText value="{0,date,dd/MM/yyyy}"><apex:param value="{!treatWrap.treat.X32c5_Date_of_last_visit__c}"/></apex:outputText>,{!treatWrap.treat.X32d5_Number_of_sessions__c},{!treatWrap.treat.Medication_Free__c},<apex:outputText value="{0,date,dd/MM/yyyy}"><apex:param value="{!treatWrap.treat.X32b6_Date_started__c}"/></apex:outputText>,<apex:outputText value="{0,date,dd/MM/yyyy}"><apex:param value="{!treatWrap.treat.X32c6_Date_of_last_visit__c}"/></apex:outputText>,{!treatWrap.treat.X32d6_Number_of_sessions__c},{!treatWrap.treat.Complementary__c},<apex:outputText value="{0,date,dd/MM/yyyy}"><apex:param value="{!treatWrap.treat.X32b7_Date_started__c}"/></apex:outputText>,<apex:outputText value="{0,date,dd/MM/yyyy}"><apex:param value="{!treatWrap.treat.X32c7_Date_of_last_visit__c}"/></apex:outputText>,{!treatWrap.treat.X32d7_Number_of_sessions__c},{!treatWrap.treat.Social_Occ__c},<apex:outputText value="{0,date,dd/MM/yyyy}"><apex:param value="{!treatWrap.treat.X32b8_Date_started__c}"/></apex:outputText>,<apex:outputText value="{0,date,dd/MM/yyyy}"><apex:param value="{!treatWrap.treat.X32c8_Date_of_last_visit__c}"/></apex:outputText>,{!treatWrap.treat.X32d8_Number_of_sessions__c},{!treatWrap.treat.Family_Therapy__c},<apex:outputText value="{0,date,dd/MM/yyyy}"><apex:param value="{!treatWrap.treat.X32b9_Date_started__c}"/></apex:outputText>,<apex:outputText value="{0,date,dd/MM/yyyy}"><apex:param value="{!treatWrap.treat.X32c9_Date_of_last_visit__c}"/></apex:outputText>,{!treatWrap.treat.X32d9_Number_of_sessions__c},{!treatWrap.treat.Aftercare__c},<apex:outputText value="{0,date,dd/MM/yyyy}"><apex:param value="{!treatWrap.treat.X32b10_Date_started__c}"/></apex:outputText>,<apex:outputText value="{0,date,dd/MM/yyyy}"><apex:param value="{!treatWrap.treat.X32c10_Date_of_last_visit__c}"/></apex:outputText>,{!treatWrap.treat.X32d10_Number_of_sessions__c},{!treatWrap.treat.Strength_Family__c},<apex:outputText value="{0,date,dd/MM/yyyy}"><apex:param value="{!treatWrap.treat.X32b11_Date_started__c}"/></apex:outputText>,<apex:outputText value="{0,date,dd/MM/yyyy}"><apex:param value="{!treatWrap.treat.X32c11_Date_of_last_visit__c}"/></apex:outputText>,{!treatWrap.treat.X32d11_Number_of_sessions__c},{!treatWrap.treat.Psychiatric__c},<apex:outputText value="{0,date,dd/MM/yyyy}"><apex:param value="{!treatWrap.treat.X32b12_Date_started__c}"/></apex:outputText>,<apex:outputText value="{0,date,dd/MM/yyyy}"><apex:param value="{!treatWrap.treat.X32c12_Date_of_last_visit__c}"/></apex:outputText>,{!treatWrap.treat.X32d12_Number_of_sessions__c},{!treatWrap.treat.Multi1__c},<apex:outputText value="{0,date,dd/MM/yyyy}"><apex:param value="{!treatWrap.treat.X32b13_Date_started__c}"/></apex:outputText>,<apex:outputText value="{0,date,dd/MM/yyyy}"><apex:param value="{!treatWrap.treat.X32c13_Date_of_last_visit__c}"/></apex:outputText>,{!treatWrap.treat.X32d13_Number_of_sessions__c},{!treatWrap.treat.Multi2__c},<apex:outputText value="{0,date,dd/MM/yyyy}"><apex:param value="{!treatWrap.treat.X32b14_Date_started__c}"/></apex:outputText>,<apex:outputText value="{0,date,dd/MM/yyyy}"><apex:param value="{!treatWrap.treat.X32c14_Date_of_last_visit__c}"/></apex:outputText>,{!treatWrap.treat.X32d14_Number_of_sessions__c},{!treatWrap.treat.Methadone__c},<apex:outputText value="{0,date,dd/MM/yyyy}"><apex:param value="{!treatWrap.treat.X32b15_Date_started__c}"/></apex:outputText>,<apex:outputText value="{0,date,dd/MM/yyyy}"><apex:param value="{!treatWrap.treat.X32c15_Date_of_last_visit__c}"/></apex:outputText>,{!treatWrap.treat.X32d15_Number_of_sessions__c},{!treatWrap.treat.Buprenorphine__c},<apex:outputText value="{0,date,dd/MM/yyyy}"><apex:param value="{!treatWrap.treat.X32b16_Date_started__c}"/></apex:outputText>,<apex:outputText value="{0,date,dd/MM/yyyy}"><apex:param value="{!treatWrap.treat.X32c16_Date_of_last_visit__c}"/></apex:outputText>,{!treatWrap.treat.X32d16_Number_of_sessions__c},{!treatWrap.treat.Detox_Alcohol__c},<apex:outputText value="{0,date,dd/MM/yyyy}"><apex:param value="{!treatWrap.treat.X32b17_Date_started__c}"/></apex:outputText>,<apex:outputText value="{0,date,dd/MM/yyyy}"><apex:param value="{!treatWrap.treat.X32c17_Date_of_last_visit__c}"/></apex:outputText>,{!treatWrap.treat.X32d17_Number_of_sessions__c},{!treatWrap.treat.Assist_Alcohol_Detox_1__c},{!treatWrap.treat.Assist_Alcohol_Detox_2__c},{!treatWrap.treat.Assist_Alcohol_Detox_3__c},{!treatWrap.treat.Detox_Heroin__c},<apex:outputText value="{0,date,dd/MM/yyyy}"><apex:param value="{!treatWrap.treat.X32b18_Date_started__c}"/></apex:outputText>,<apex:outputText value="{0,date,dd/MM/yyyy}"><apex:param value="{!treatWrap.treat.X32c18_Date_of_last_visit__c}"/></apex:outputText>,{!treatWrap.treat.X32d18_Number_of_sessions__c},{!treatWrap.treat.Assist_Heroin_Detox_1__c},{!treatWrap.treat.Assist_Heroin_Detox_2__c},{!treatWrap.treat.Assist_Heroin_Detox_3__c},{!treatWrap.treat.Detox_Methadone__c},<apex:outputText value="{0,date,dd/MM/yyyy}"><apex:param value="{!treatWrap.treat.X32b19_Date_started__c}"/></apex:outputText>,<apex:outputText value="{0,date,dd/MM/yyyy}"><apex:param value="{!treatWrap.treat.X32c19_Date_of_last_visit__c}"/></apex:outputText>,{!treatWrap.treat.X32d19_Number_of_sessions__c},{!treatWrap.treat.Assist_Methadone_Detox1__c},{!treatWrap.treat.Assist_Methadone_Detox2__c},{!treatWrap.treat.Assist_Methadone_Detox3__c},{!treatWrap.treat.Detox_Benzo__c},<apex:outputText value="{0,date,dd/MM/yyyy}"><apex:param value="{!treatWrap.treat.X32b20_Date_started__c}"/></apex:outputText>,<apex:outputText value="{0,date,dd/MM/yyyy}"><apex:param value="{!treatWrap.treat.X32c20_Date_of_last_visit__c}"/></apex:outputText>,{!treatWrap.treat.X32d20_Number_of_sessions__c},{!treatWrap.treat.Assist_Benzo_Detox_1__c},{!treatWrap.treat.Assist_Benzo_Detox_2__c},{!treatWrap.treat.Assist_Benzo_Detox_3__c},{!treatWrap.treat.Detox_Zdrugs__c},<apex:outputText value="{0,date,dd/MM/yyyy}"><apex:param value="{!treatWrap.treat.X32b21_Date_started__c}"/></apex:outputText>,<apex:outputText value="{0,date,dd/MM/yyyy}"><apex:param value="{!treatWrap.treat.X32c21_Date_of_last_visit__c}"/></apex:outputText>,{!treatWrap.treat.X32d21_Number_of_sessions__c},{!treatWrap.treat.Assist_ZDrugs_Detox_1__c},{!treatWrap.treat.Assist_ZDrugs_Detox_2__c},{!treatWrap.treat.Assist_ZDrugs_Detox_3__c},{!treatWrap.treat.Detox_Other__c},{!treatWrap.treat.Detox_Other_Specify__c},<apex:outputText value="{0,date,dd/MM/yyyy}"><apex:param value="{!treatWrap.treat.X32b22_Date_started__c}"/></apex:outputText>,<apex:outputText value="{0,date,dd/MM/yyyy}"><apex:param value="{!treatWrap.treat.X32c22_Date_of_last_visit__c}"/></apex:outputText>,{!treatWrap.treat.X32d22_Number_of_sessions__c},{!treatWrap.treat.Assist_Other_Detox_1__c},{!treatWrap.treat.Assist_Other_Detox_2__c},{!treatWrap.treat.Assist_Other_Detox_3__c},{!treatWrap.treat.Detox_Community__c},<apex:outputText value="{0,date,dd/MM/yyyy}"><apex:param value="{!treatWrap.treat.X32b23_Date_started__c}"/></apex:outputText>,<apex:outputText value="{0,date,dd/MM/yyyy}"><apex:param value="{!treatWrap.treat.X32c23_Date_of_last_visit__c}"/></apex:outputText>,{!treatWrap.treat.X32d23_Number_of_sessions__c},{!treatWrap.treat.Key_Worker__c},<apex:outputText value="{0,date,dd/MM/yyyy}"><apex:param value="{!treatWrap.treat.X32b24_Date_started__c}"/></apex:outputText>,<apex:outputText value="{0,date,dd/MM/yyyy}"><apex:param value="{!treatWrap.treat.X32c24_Date_of_last_visit__c}"/></apex:outputText>,{!treatWrap.treat.X32d24_Number_of_sessions__c},{!treatWrap.treat.Case_Manager__c},<apex:outputText value="{0,date,dd/MM/yyyy}"><apex:param value="{!treatWrap.treat.X32b25_Date_started__c}"/></apex:outputText>,{!treatWrap.treat.Care_Plan__c},<apex:outputText value="{0,date,dd/MM/yyyy}"><apex:param value="{!treatWrap.treat.X32b26_Date_started__c}"/></apex:outputText>,{!treatWrap.treat.SAOR__c},<apex:outputText value="{0,date,dd/MM/yyyy}"><apex:param value="{!treatWrap.treat.X32b27_Date_started__c}"/></apex:outputText>,<apex:outputText value="{0,date,dd/MM/yyyy}"><apex:param value="{!treatWrap.treat.X32c27_Date_of_last_visit__c}"/></apex:outputText>,{!treatWrap.treat.X32d27_Number_of_sessions__c},{!treatWrap.treat.Other2__c},<apex:outputText value="{0,date,dd/MM/yyyy}"><apex:param value="{!treatWrap.treat.X32b28_Date_started__c}"/></apex:outputText>,<apex:outputText value="{0,date,dd/MM/yyyy}"><apex:param value="{!treatWrap.treat.X32c28_Date_of_last_visit__c}"/></apex:outputText>,{!treatWrap.treat.X32d28_Number_of_Sessions__c},,,,,0,FALSE,FALSE,FALSE,FALSE,FALSE,FALSE,FALSE,FALSE,FALSE,FALSE,FALSE,FALSE,FALSE,FALSE,FALSE,,FALSE,17. Other: CP,<apex:outputText value="{0,date,dd/MM/yyyy}"><apex:param value="{!treatWrap.treat.X35_Date_of_Final_Discharge_or_transfer__c}"/></apex:outputText>,{!treatWrap.treat.UniqID__c},,{!treatWrap.treat.Created_By__c}</apex:outputText>
<apex:outputText rendered="{!!treatWrap.treat.ISConcernedPerson__c}">,{!treatWrap.treat.Contact__r.County_code_for_HRB__c},,,,,{!treatWrap.treat.Contact__r.Small_Area__c},{!treatWrap.treat.Contact__r.DED__c},{!treatWrap.treat.Contact__r.LHO_Code__c},{!treatWrap.treat.Contact__r.TFA_Code__c},{!treatWrap.treat.Contact__r.CHO__c},,{!treatWrap.treat.Centre_number__c},{!treatWrap.treat.CentreType__c},{!treatWrap.treat.Contact__r.NUMBER__c},{!treatWrap.treat.Contact__r.X2b_IHI__c},,{!treatWrap.treat.Contact__r.Sex__c},{!treatWrap.treat.Contact__r.Transgender_Code__c},{!treatWrap.treat.Contact__r.Sexuality_Code__c},<apex:outputText value="{0,date,dd/MM/yyyy}"><apex:param value="{!treatWrap.treat.Contact__r.Birthdate}"/></apex:outputText>,{!treatWrap.treat.Age__c},{!treatWrap.treat.Contact__r.Living_Where__c},{!treatWrap.treat.Contact__r.Living_With__c},{!treatWrap.treat.Contact__r.X6_Total_Number_of_Children__c},{!treatWrap.treat.Contact__r.X6a1_Children_under_5yrs_living_whith__c},{!treatWrap.treat.Contact__r.X6a2_Children_5_17yrs_living_whith_clien__c},{!treatWrap.treat.Contact__r.X6a3_Children_18yrs_or_over_living_whith__c},{!treatWrap.treat.Contact__r.Living_with_service_user_unknown__c},{!treatWrap.treat.Contact__r.X6b1_Children_under_5_yrs_living_w_other__c},{!treatWrap.treat.Contact__r.X6b2_Children_5_17yrs_living_w_other__c},{!treatWrap.treat.Contact__r.X6b3_Children_18yrs_or_over_living_other__c},{!treatWrap.treat.Contact__r.Living_with_other_parent_unknown__c},{!treatWrap.treat.Contact__r.X6c1_Children_under_5yrs_in_care__c},{!treatWrap.treat.Contact__r.X6c2_Children_5_17yrs_in_care__c},{!treatWrap.treat.Contact__r.X6c3_Children_18yrs_or_over_in_care__c},{!treatWrap.treat.Contact__r.Number_in_care_unknown__c},{!treatWrap.treat.Contact__r.X6d1_Children_under_5yrs_living_elsewher__c},{!treatWrap.treat.Contact__r.X6d2_Children_5_17yrs_living_elsewhere__c},{!treatWrap.treat.Contact__r.X6d3_Children_18yrs_or_over_living_elsew__c},{!treatWrap.treat.Contact__r.Living_elsewhere_unknown__c},{!treatWrap.treat.Contact__r.X6e1_Children_under_5yrs_living_not_know__c},{!treatWrap.treat.Contact__r.X6e2_Children_5_17yrs_living_not_know__c},{!treatWrap.treat.Contact__r.X6e3_Children_18yrs_or_over_living_not_k__c},{!treatWrap.treat.Contact__r.Living_status_not_known_unknown__c},{!treatWrap.treat.Contact__r.EDUCATION__c},{!treatWrap.treat.Contact__r.Education_Age__c},{!treatWrap.treat.Contact__r.EMPLOYMENT__c},{!treatWrap.treat.Contact__r.X10_8_Specify_other_employment_status__c},{!treatWrap.treat.Contact__r.Country_Of_Birth__c},{!treatWrap.treat.Contact__r.Ethnic_cultural_background__c},{!treatWrap.treat.Contact__r.Language__c},<apex:outputText value="{0,date,dd/MM/yyyy}"><apex:param value="{!treatWrap.treat.X12_Date_of_Referral__c}"/></apex:outputText>,{!treatWrap.treat.X13_2_Drug_specify__r.Item_Code__c},{!treatWrap.treat.Source_of_Referral__c},<apex:outputText value="{0,date,dd/MM/yyyy}"><apex:param value="{!treatWrap.treat.X15_Date_of_initial_assessment__c}"/></apex:outputText>,{!treatWrap.treat.Assessment_Outcome__c},{!treatWrap.treat.ClientSuitable__c},{!treatWrap.treat.X17_9_Ohter_specify__c},{!treatWrap.treat.Times__c},{!treatWrap.treat.Drug_History__c},{!treatWrap.treat.X19b_Age_first_treated_Drugs__c},{!treatWrap.treat.Alcohol_History__c},{!treatWrap.treat.X19d_Age_first_treated_Alcohol__c},{!treatWrap.treat.Other_Problem_Name__c},{!treatWrap.treat.Other_Problem_History__c},{!treatWrap.treat.X19b_Age_first_treated_Other__c},{!treatWrap.treat.Ever_Received_OpiateSub__c},{!treatWrap.treat.Age_1st_OpiateSub__c},{!treatWrap.treat.Drug_1_Detail__c},{!treatWrap.treat.Drug_1_Route__c},{!treatWrap.treat.Drug_1_Frequency__c},{!treatWrap.treat.X21d_Age_at_1st_use__c},{!treatWrap.treat.Drug_2_Detail__c},{!treatWrap.treat.Drug_2_Route__c},{!treatWrap.treat.Drug_2_Frequency__c},{!treatWrap.treat.X22d_Age_of_1st_use__c},{!treatWrap.treat.Drug_3_Detail__c},{!treatWrap.treat.Drug_3_Route__c},{!treatWrap.treat.Drug_3_Frequency__c},{!treatWrap.treat.X23d_Age_of_1st_use__c},{!treatWrap.treat.Drug_4_Detail__c},{!treatWrap.treat.Drug_4_Route__c},{!treatWrap.treat.Drug_4_Frequency__c},{!treatWrap.treat.X24d_Age_of_1st_use__c},{!treatWrap.treat.Drug_5_Detail__c},{!treatWrap.treat.Drug_5_Route__c},{!treatWrap.treat.Drug_5_Frequency__c},{!treatWrap.treat.X25d_Age_of_1st_use__c},{!treatWrap.treat.X26_Age_first_use_any_drug__c},{!treatWrap.treat.First_Drug_Detail__c},{!treatWrap.treat.Difficult_To_Assess__c},{!treatWrap.treat.Prefer_Beer__c},{!treatWrap.treat.Prefer_Spirits__c},{!treatWrap.treat.Prefer_Wine__c},{!treatWrap.treat.Prefer_Fortified__c},{!treatWrap.treat.Prefer_Cider__c},{!treatWrap.treat.Prefer_Alcopops__c},{!treatWrap.treat.Prefer_Other_Alcohol__c},{!treatWrap.treat.X29a8_Specify_Other__c},{!treatWrap.treat.X29b_How_many_drinks_per_occasion__c},{!treatWrap.treat.Extent_Problem__c},{!treatWrap.treat.X29d_Number_of_previous_alcohol_detoxes__c},{!treatWrap.treat.Injected_Ever__c},{!treatWrap.treat.X30b_Age_first_injected__c},{!treatWrap.treat.Injected_Frequency__c},{!treatWrap.treat.Shared_Needle__c},{!treatWrap.treat.Shared_Other__c},{!treatWrap.treat.HepC_Test__c},{!treatWrap.treat.HepB_Test__c},{!treatWrap.treat.HIV_Test__c},{!treatWrap.treat.Brief_Intervention__c},<apex:outputText value="{0,date,dd/MM/yyyy}"><apex:param value="{!treatWrap.treat.X32b1_Date_started__c}"/></apex:outputText>,<apex:outputText value="{0,date,dd/MM/yyyy}"><apex:param value="{!treatWrap.treat.X32c1_Date_of_last_visit__c}"/></apex:outputText>,{!treatWrap.treat.X32d1_Number_of_sessions__c},{!treatWrap.treat.Counsel_Individual__c},<apex:outputText value="{0,date,dd/MM/yyyy}"><apex:param value="{!treatWrap.treat.X32b2_Date_started__c}"/></apex:outputText>,<apex:outputText value="{0,date,dd/MM/yyyy}"><apex:param value="{!treatWrap.treat.X32c2_Date_of_last_visit__c}"/></apex:outputText>,{!treatWrap.treat.X32d2_Number_of_sessions__c},{!treatWrap.treat.Counsel_Group__c},<apex:outputText value="{0,date,dd/MM/yyyy}"><apex:param value="{!treatWrap.treat.X32b3_Date_started__c}"/></apex:outputText>,<apex:outputText value="{0,date,dd/MM/yyyy}"><apex:param value="{!treatWrap.treat.X32c3_Date_of_last_visit__c}"/></apex:outputText>,{!treatWrap.treat.X32d3_Number_of_sessions__c},{!treatWrap.treat.Individual_Edu__c},<apex:outputText value="{0,date,dd/MM/yyyy}"><apex:param value="{!treatWrap.treat.X32b4_Date_started__c}"/></apex:outputText>,<apex:outputText value="{0,date,dd/MM/yyyy}"><apex:param value="{!treatWrap.treat.X32c4_Date_of_last_visit__c}"/></apex:outputText>,{!treatWrap.treat.X32d4_Number_of_sessions__c},{!treatWrap.treat.Group_Edu__c},<apex:outputText value="{0,date,dd/MM/yyyy}"><apex:param value="{!treatWrap.treat.X32b5_Date_started__c}"/></apex:outputText>,<apex:outputText value="{0,date,dd/MM/yyyy}"><apex:param value="{!treatWrap.treat.X32c5_Date_of_last_visit__c}"/></apex:outputText>,{!treatWrap.treat.X32d5_Number_of_sessions__c},{!treatWrap.treat.Medication_Free__c},<apex:outputText value="{0,date,dd/MM/yyyy}"><apex:param value="{!treatWrap.treat.X32b6_Date_started__c}"/></apex:outputText>,<apex:outputText value="{0,date,dd/MM/yyyy}"><apex:param value="{!treatWrap.treat.X32c6_Date_of_last_visit__c}"/></apex:outputText>,{!treatWrap.treat.X32d6_Number_of_sessions__c},{!treatWrap.treat.Complementary__c},<apex:outputText value="{0,date,dd/MM/yyyy}"><apex:param value="{!treatWrap.treat.X32b7_Date_started__c}"/></apex:outputText>,<apex:outputText value="{0,date,dd/MM/yyyy}"><apex:param value="{!treatWrap.treat.X32c7_Date_of_last_visit__c}"/></apex:outputText>,{!treatWrap.treat.X32d7_Number_of_sessions__c},{!treatWrap.treat.Social_Occ__c},<apex:outputText value="{0,date,dd/MM/yyyy}"><apex:param value="{!treatWrap.treat.X32b8_Date_started__c}"/></apex:outputText>,<apex:outputText value="{0,date,dd/MM/yyyy}"><apex:param value="{!treatWrap.treat.X32c8_Date_of_last_visit__c}"/></apex:outputText>,{!treatWrap.treat.X32d8_Number_of_sessions__c},{!treatWrap.treat.Family_Therapy__c},<apex:outputText value="{0,date,dd/MM/yyyy}"><apex:param value="{!treatWrap.treat.X32b9_Date_started__c}"/></apex:outputText>,<apex:outputText value="{0,date,dd/MM/yyyy}"><apex:param value="{!treatWrap.treat.X32c9_Date_of_last_visit__c}"/></apex:outputText>,{!treatWrap.treat.X32d9_Number_of_sessions__c},{!treatWrap.treat.Aftercare__c},<apex:outputText value="{0,date,dd/MM/yyyy}"><apex:param value="{!treatWrap.treat.X32b10_Date_started__c}"/></apex:outputText>,<apex:outputText value="{0,date,dd/MM/yyyy}"><apex:param value="{!treatWrap.treat.X32c10_Date_of_last_visit__c}"/></apex:outputText>,{!treatWrap.treat.X32d10_Number_of_sessions__c},{!treatWrap.treat.Strength_Family__c},<apex:outputText value="{0,date,dd/MM/yyyy}"><apex:param value="{!treatWrap.treat.X32b11_Date_started__c}"/></apex:outputText>,<apex:outputText value="{0,date,dd/MM/yyyy}"><apex:param value="{!treatWrap.treat.X32c11_Date_of_last_visit__c}"/></apex:outputText>,{!treatWrap.treat.X32d11_Number_of_sessions__c},{!treatWrap.treat.Psychiatric__c},<apex:outputText value="{0,date,dd/MM/yyyy}"><apex:param value="{!treatWrap.treat.X32b12_Date_started__c}"/></apex:outputText>,<apex:outputText value="{0,date,dd/MM/yyyy}"><apex:param value="{!treatWrap.treat.X32c12_Date_of_last_visit__c}"/></apex:outputText>,{!treatWrap.treat.X32d12_Number_of_sessions__c},{!treatWrap.treat.Multi1__c},<apex:outputText value="{0,date,dd/MM/yyyy}"><apex:param value="{!treatWrap.treat.X32b13_Date_started__c}"/></apex:outputText>,<apex:outputText value="{0,date,dd/MM/yyyy}"><apex:param value="{!treatWrap.treat.X32c13_Date_of_last_visit__c}"/></apex:outputText>,{!treatWrap.treat.X32d13_Number_of_sessions__c},{!treatWrap.treat.Multi2__c},<apex:outputText value="{0,date,dd/MM/yyyy}"><apex:param value="{!treatWrap.treat.X32b14_Date_started__c}"/></apex:outputText>,<apex:outputText value="{0,date,dd/MM/yyyy}"><apex:param value="{!treatWrap.treat.X32c14_Date_of_last_visit__c}"/></apex:outputText>,{!treatWrap.treat.X32d14_Number_of_sessions__c},{!treatWrap.treat.Methadone__c},<apex:outputText value="{0,date,dd/MM/yyyy}"><apex:param value="{!treatWrap.treat.X32b15_Date_started__c}"/></apex:outputText>,<apex:outputText value="{0,date,dd/MM/yyyy}"><apex:param value="{!treatWrap.treat.X32c15_Date_of_last_visit__c}"/></apex:outputText>,{!treatWrap.treat.X32d15_Number_of_sessions__c},{!treatWrap.treat.Buprenorphine__c},<apex:outputText value="{0,date,dd/MM/yyyy}"><apex:param value="{!treatWrap.treat.X32b16_Date_started__c}"/></apex:outputText>,<apex:outputText value="{0,date,dd/MM/yyyy}"><apex:param value="{!treatWrap.treat.X32c16_Date_of_last_visit__c}"/></apex:outputText>,{!treatWrap.treat.X32d16_Number_of_sessions__c},{!treatWrap.treat.Detox_Alcohol__c},<apex:outputText value="{0,date,dd/MM/yyyy}"><apex:param value="{!treatWrap.treat.X32b17_Date_started__c}"/></apex:outputText>,<apex:outputText value="{0,date,dd/MM/yyyy}"><apex:param value="{!treatWrap.treat.X32c17_Date_of_last_visit__c}"/></apex:outputText>,{!treatWrap.treat.X32d17_Number_of_sessions__c},{!treatWrap.treat.Assist_Alcohol_Detox_1__c},{!treatWrap.treat.Assist_Alcohol_Detox_2__c},{!treatWrap.treat.Assist_Alcohol_Detox_3__c},{!treatWrap.treat.Detox_Heroin__c},<apex:outputText value="{0,date,dd/MM/yyyy}"><apex:param value="{!treatWrap.treat.X32b18_Date_started__c}"/></apex:outputText>,<apex:outputText value="{0,date,dd/MM/yyyy}"><apex:param value="{!treatWrap.treat.X32c18_Date_of_last_visit__c}"/></apex:outputText>,{!treatWrap.treat.X32d18_Number_of_sessions__c},{!treatWrap.treat.Assist_Heroin_Detox_1__c},{!treatWrap.treat.Assist_Heroin_Detox_2__c},{!treatWrap.treat.Assist_Heroin_Detox_3__c},{!treatWrap.treat.Detox_Methadone__c},<apex:outputText value="{0,date,dd/MM/yyyy}"><apex:param value="{!treatWrap.treat.X32b19_Date_started__c}"/></apex:outputText>,<apex:outputText value="{0,date,dd/MM/yyyy}"><apex:param value="{!treatWrap.treat.X32c19_Date_of_last_visit__c}"/></apex:outputText>,{!treatWrap.treat.X32d19_Number_of_sessions__c},{!treatWrap.treat.Assist_Methadone_Detox1__c},{!treatWrap.treat.Assist_Methadone_Detox2__c},{!treatWrap.treat.Assist_Methadone_Detox3__c},{!treatWrap.treat.Detox_Benzo__c},<apex:outputText value="{0,date,dd/MM/yyyy}"><apex:param value="{!treatWrap.treat.X32b20_Date_started__c}"/></apex:outputText>,<apex:outputText value="{0,date,dd/MM/yyyy}"><apex:param value="{!treatWrap.treat.X32c20_Date_of_last_visit__c}"/></apex:outputText>,{!treatWrap.treat.X32d20_Number_of_sessions__c},{!treatWrap.treat.Assist_Benzo_Detox_1__c},{!treatWrap.treat.Assist_Benzo_Detox_2__c},{!treatWrap.treat.Assist_Benzo_Detox_3__c},{!treatWrap.treat.Detox_Zdrugs__c},<apex:outputText value="{0,date,dd/MM/yyyy}"><apex:param value="{!treatWrap.treat.X32b21_Date_started__c}"/></apex:outputText>,<apex:outputText value="{0,date,dd/MM/yyyy}"><apex:param value="{!treatWrap.treat.X32c21_Date_of_last_visit__c}"/></apex:outputText>,{!treatWrap.treat.X32d21_Number_of_sessions__c},{!treatWrap.treat.Assist_ZDrugs_Detox_1__c},{!treatWrap.treat.Assist_ZDrugs_Detox_2__c},{!treatWrap.treat.Assist_ZDrugs_Detox_3__c},{!treatWrap.treat.Detox_Other__c},{!treatWrap.treat.Detox_Other_Specify__c},<apex:outputText value="{0,date,dd/MM/yyyy}"><apex:param value="{!treatWrap.treat.X32b22_Date_started__c}"/></apex:outputText>,<apex:outputText value="{0,date,dd/MM/yyyy}"><apex:param value="{!treatWrap.treat.X32c22_Date_of_last_visit__c}"/></apex:outputText>,{!treatWrap.treat.X32d22_Number_of_sessions__c},{!treatWrap.treat.Assist_Other_Detox_1__c},{!treatWrap.treat.Assist_Other_Detox_2__c},{!treatWrap.treat.Assist_Other_Detox_3__c},{!treatWrap.treat.Detox_Community__c},<apex:outputText value="{0,date,dd/MM/yyyy}"><apex:param value="{!treatWrap.treat.X32b23_Date_started__c}"/></apex:outputText>,<apex:outputText value="{0,date,dd/MM/yyyy}"><apex:param value="{!treatWrap.treat.X32c23_Date_of_last_visit__c}"/></apex:outputText>,{!treatWrap.treat.X32d23_Number_of_sessions__c},{!treatWrap.treat.Key_Worker__c},<apex:outputText value="{0,date,dd/MM/yyyy}"><apex:param value="{!treatWrap.treat.X32b24_Date_started__c}"/></apex:outputText>,<apex:outputText value="{0,date,dd/MM/yyyy}"><apex:param value="{!treatWrap.treat.X32c24_Date_of_last_visit__c}"/></apex:outputText>,{!treatWrap.treat.X32d24_Number_of_sessions__c},{!treatWrap.treat.Case_Manager__c},<apex:outputText value="{0,date,dd/MM/yyyy}"><apex:param value="{!treatWrap.treat.X32b25_Date_started__c}"/></apex:outputText>,{!treatWrap.treat.Care_Plan__c},<apex:outputText value="{0,date,dd/MM/yyyy}"><apex:param value="{!treatWrap.treat.X32b26_Date_started__c}"/></apex:outputText>,{!treatWrap.treat.SAOR__c},<apex:outputText value="{0,date,dd/MM/yyyy}"><apex:param value="{!treatWrap.treat.X32b27_Date_started__c}"/></apex:outputText>,<apex:outputText value="{0,date,dd/MM/yyyy}"><apex:param value="{!treatWrap.treat.X32c27_Date_of_last_visit__c}"/></apex:outputText>,{!treatWrap.treat.X32d27_Number_of_sessions__c},{!treatWrap.treat.Other2__c},<apex:outputText value="{0,date,dd/MM/yyyy}"><apex:param value="{!treatWrap.treat.X32b28_Date_started__c}"/></apex:outputText>,<apex:outputText value="{0,date,dd/MM/yyyy}"><apex:param value="{!treatWrap.treat.X32c28_Date_of_last_visit__c}"/></apex:outputText>,{!treatWrap.treat.X32d28_Number_of_Sessions__c},{!treatWrap.treat.Exit_Reason__c},{!treatWrap.treat.Exit_Centre__c},{!treatWrap.treat.Premature_Exit_Reason__c},{!treatWrap.treat.X33a10_Exit_detail_Other__c},{!treatWrap.treat.X33b_Number_of_others_involved__c},{!treatWrap.treat.Exit_Drug_Free__c},{!treatWrap.treat.Exit_Drug_UnChanged__c},{!treatWrap.treat.Exit_Drug_Increased__c},{!treatWrap.treat.Exit_Drug_Reduced__c},{!treatWrap.treat.Exit_Alcohol_Free__c},{!treatWrap.treat.Exit_Alcohol_UnChanged__c},{!treatWrap.treat.Exit_Alcohol_Increased__c},{!treatWrap.treat.Exit_Alcohol_Reduced__c},{!treatWrap.treat.Exit_Reached_Goals__c},{!treatWrap.treat.Exit_Engaging_Careplan__c},{!treatWrap.treat.Exit_Disengaged_Careplan__c},{!treatWrap.treat.Exit_Careplan_Gaps__c},{!treatWrap.treat.Exit_Engaging_Services__c},{!treatWrap.treat.Exit_Engaging_Therapeutic__c},{!treatWrap.treat.Exit_Unstructured_Aftercare__c},{!treatWrap.treat.Exit_Other__c},{!treatWrap.treat.Not_Known__c},{!treatWrap.treat.Exit_Unknown__c},<apex:outputText value="{0,date,dd/MM/yyyy}"><apex:param value="{!treatWrap.treat.X35_Date_of_Final_Discharge_or_transfer__c}"/></apex:outputText>,{!treatWrap.treat.UniqID__c},{!treatWrap.treat.Episode_Comment__c},{!treatWrap.treat.Created_By__c}</apex:outputText>
        </apex:repeat>
</apex:page>
<!--

    Fields to do:
[Smallarea] -- as soon as figure it out - added placeholder to list of fields above
  ,[LanguageSpecify] -- added a placeholder, waiting on response from Derek

 [Inter34] ,[InterCommDate34] ,[InterEndDate34] ,[InterNumber34],[Inter35] ,[InterCommDate35] ,[InterEndDate35] ,[InterNumber35] ,  [DetoxDrug1] ,[DetoxDrug2] ,[DetoxDrug3]- Using the field Placeholder for end section G
 ,[NonCompliance] ,[ExitCentre] ,[ExitCentreText] ,[NumberCP] ,[ExitCondDrugFree] ,[ExitCondDrugUnChan] ,[ExitCondDrugIn] ,[ExitCondDrugDe] ,[ExitCondAlcFree] ,[ExitCondAlcUnChan] ,[ExitCondAlcIn] ,[ExitCondAlcDe] ,[SubPriGoal] ,[EngagPlan] ,[DisengPlan] ,[GapPlan] ,[EngagOthSer] ,[EngagOthThpy] ,[EngagOthUnSt] ,[ExitCondSpecify] ,[ExitCondUnknown] ,[ExitDate] ,[UniqID] ,[Comments],[AddedBy]
-->